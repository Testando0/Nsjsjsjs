<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Image Gen - Fix 405</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #000; color: #0f0; display: flex; justify-content: center; padding: 20px; }
        .terminal { background: #111; border: 1px solid #0f0; padding: 20px; border-radius: 5px; width: 100%; max-width: 600px; box-shadow: 0 0 15px rgba(0, 255, 0, 0.2); }
        button { width: 100%; padding: 15px; background: #0f0; color: #000; border: none; cursor: pointer; font-weight: bold; margin-bottom: 20px; }
        button:disabled { background: #050; cursor: wait; }
        pre { background: #000; padding: 15px; border: 1px solid #333; overflow-x: auto; font-size: 12px; color: #0fa; min-height: 100px; }
        #imageBox img { width: 100%; margin-top: 15px; border: 1px solid #0f0; }
    </style>
</head>
<body>

<div class="terminal">
    <h2>> REQUEST_GENERATOR</h2>
    <button id="execBtn">EXECUTAR POST REQUEST</button>
    <div id="log">Status: Aguardando...</div>
    <pre id="console">Log de saída...</pre>
    <div id="imageBox"></div>
</div>

<script>
    const execBtn = document.getElementById('execBtn');
    const log = document.getElementById('log');
    const consoleBox = document.getElementById('console');
    const imageBox = document.getElementById('imageBox');

    execBtn.addEventListener('click', async () => {
        execBtn.disabled = true;
        log.innerText = "Status: Enviando via Proxy Seguro...";
        consoleBox.innerText = "Iniciando fetch...";
        imageBox.innerHTML = "";

        const targetUrl = 'https://api.felo.ai/v1/gemini-image-gen';
        
        // Tentaremos usar o proxy da ThingProxy ou o AnyOrigin que aceitam POST mais livremente
        const proxyUrl = 'https://thingproxy.freeboard.io/fetch/'; 

        const payload = {
            "prompt": "A cyberpunk city at night, neon signs in Japanese, ultra detailed, 4k",
            "resolution": "2048x2048",
            "model": "gemini-3-pro-image-preview"
        };

        try {
            const response = await fetch(proxyUrl + targetUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer free',
                    // Cabeçalhos para simular uma requisição legítima
                    'Accept': 'application/json'
                },
                body: JSON.stringify(payload)
            });

            if (response.status === 405) {
                throw new Error("Erro 405: O servidor da Felo.ai rejeitou o método POST deste proxy. Tente outro proxy ou verifique se a URL mudou.");
            }

            const data = await response.json();
            consoleBox.innerText = JSON.stringify(data, null, 2);
            log.innerText = "Status: Resposta recebida!";

            // Se a API retornar imagem
            const imgUrl = data.url || (data.data && data.data[0]?.url);
            if (imgUrl) {
                imageBox.innerHTML = `<img src="${imgUrl}">`;
            }

        } catch (error) {
            log.innerText = "Status: Falha na operação.";
            consoleBox.innerText = "DETALHES: " + error.message;
            console.error(error);
        } finally {
            execBtn.disabled = false;
        }
    });
</script>

</body>
</html>
